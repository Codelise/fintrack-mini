(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79899,e=>{"use strict";e.s(["UserProvider",()=>s,"useUser",()=>l]);var t=e.i(43476),r=e.i(71645),a=e.i(22459);let n=(0,r.createContext)();function s(e){var s;let{children:l,initialSession:i}=e,[o,u]=(0,r.useState)(null!=(s=null==i?void 0:i.user)?s:null),[c,d]=(0,r.useState)(!1),[y,g]=(0,r.useState)(!i);return(0,r.useEffect)(()=>{let e=!0,t=()=>{let{data:{subscription:e}}=a.supabase.auth.onAuthStateChange(async(e,t)=>{var r;u(null!=(r=null==t?void 0:t.user)?r:null),g(!1),"SIGNED_OUT"===e&&d(!1)});return()=>e.unsubscribe()};if(i&&i.user)return t();(async()=>{try{let{data:{session:e},error:t}=await a.supabase.auth.getSession();if(t)return void console.error("Error getting session:",t);(null==e?void 0:e.user)?u(e.user):u(null)}catch(e){console.error("Error in getSession:",e)}finally{e&&g(!1)}})();let r=t();return()=>{e=!1,"function"==typeof r&&r()}},[i]),(0,t.jsx)(n.Provider,{value:{user:o,setUser:u,isOnboarded:c,setIsOnboarded:d,loading:y},children:l})}let l=()=>{let e=(0,r.useContext)(n);if(!e)throw Error("useUser must be used within a UserProvider");return e}},86647,e=>{"use strict";e.s(["default",()=>m,"transactionKeys",()=>w,"useTransactions",()=>f],86647);var t=e.i(66027),r=e.i(54616),a=e.i(12598),n=e.i(22459);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.supabase.from("transactions").select("*, categories (*)").eq("user_id",e);t.wallet_id&&(r=r.eq("wallet_id",t.wallet_id)),t.startDate&&t.endDate&&(r=r.gte("date",t.startDate).lte("date",t.endDate));let{data:a,error:s}=await r.order("date",{ascending:!1});return{data:a,error:s}}async function l(e){let{data:t,error:r}=await n.supabase.from("transactions").insert([e]).select();return{data:t,error:r}}async function i(e,t){let{data:r,error:a}=await n.supabase.from("transactions").update(t).eq("transaction_id",e).select();return{data:r,error:a}}async function o(e){let{data:t,error:r}=await n.supabase.from("transactions").delete().eq("transaction_id",e);return{data:t,error:r}}async function u(e){let{data:t,error:r}=await n.supabase.from("transactions").select("*, categories (*)").eq("transaction_id",e).single();return{data:t,error:r}}async function c(e,t){let{data:r,error:a}=await n.supabase.from("transactions").select("*, categories (*)").eq("user_id",e).eq("wallet_id",t).order("date",{ascending:!1});return{data:r,error:a}}async function d(e,t){let{data:r,error:a}=await n.supabase.from("transactions").select("*, categories (*)").eq("user_id",e).eq("category_id",t).order("date",{ascending:!1});return{data:r,error:a}}async function y(e,t,r){let{data:a,error:s}=await n.supabase.from("transactions").select("*, categories (*)").eq("user_id",e).gte("date",t).lte("date",r).order("date",{ascending:!1});return{data:a,error:s}}let g=new class{async getTransactions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await s(e,t)}catch(e){return console.error("Error fetching transactions:",e),{data:null,error:e}}}async getTransactionById(e){try{return await u(e)}catch(e){return console.error("Error fetching transaction:",e),{data:null,error:e}}}async createTransaction(e){try{if(console.log("üéØ Transaction Service - Creating transaction with data:",JSON.stringify(e,null,2)),!e.user_id||!e.amount||!e.transaction_type||!e.date)throw console.error("‚ùå Missing required fields:",{user_id:e.user_id,amount:e.amount,transaction_type:e.transaction_type,date:e.date}),Error("User ID, amount, transaction type, and date are required");if(e.amount<=0)throw Error("Transaction amount must be greater than 0");let t=await l(e);return console.log("‚úÖ Transaction creation result:",t),t}catch(e){return console.error("‚ùå Error creating transaction:",e),{data:null,error:e}}}async updateTransaction(e,t){try{if(console.log("Service: Updating transaction",e,t),!e)throw Error("Transaction ID is required");if(t.amount&&t.amount<=0)throw Error("Transaction amount must be greater than 0");let r=await i(e,t);if(console.log("Service: Update result",r),r.error)throw console.error("Service: Update failed:",r.error),r.error;return r}catch(e){throw console.error("Service: Error updating transaction:",e),e}}async deleteTransaction(e){try{return await o(e)}catch(e){return console.error("Error deleting transaction:",e),{error:e}}}async getTransactionsByWallet(e,t){try{return await c(e,t)}catch(e){return console.error("Error fetching wallet transactions:",e),{data:null,error:e}}}async getTransactionsByCategory(e,t){try{return await d(e,t)}catch(e){return console.error("Error fetching category transactions:",e),{data:null,error:e}}}async getTransactionsByDateRange(e,t,r){try{return await y(e,t,r)}catch(e){return console.error("Error fetching transactions by date range:",e),{data:null,error:e}}}},w={all:["transactions"],lists:()=>[...w.all,"list"],list:e=>[...w.lists(),{filters:e}],details:()=>[...w.all,"detail"],detail:e=>[...w.details(),e],byWallet:e=>[...w.lists(),{walletId:e}],byCategory:e=>[...w.lists(),{categoryId:e}],byDateRange:(e,t)=>[...w.lists(),{startDate:e,endDate:t}]},f=()=>{let e=(0,a.useQueryClient)(),n=(0,r.useMutation)({mutationFn:g.createTransaction,onSuccess:t=>{t.data&&(e.invalidateQueries({queryKey:w.lists()}),e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["reports"]}))},onError:e=>{console.error("Error creating transaction:",e)}}),s=(0,r.useMutation)({mutationFn:e=>{let{transactionId:t,updates:r}=e;return g.updateTransaction(t,r)},onSuccess:(t,r)=>{t.data&&(e.setQueryData(w.detail(r.transactionId),t.data[0]),e.setQueryData(w.lists(),e=>null==e?void 0:e.map(e=>e.transaction_id===r.transactionId?t.data[0]:e)),e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["reports"]}))},onError:e=>{console.error("Error updating transaction:",e)}}),l=(0,r.useMutation)({mutationFn:g.deleteTransaction,onSuccess:(t,r)=>{e.removeQueries({queryKey:w.detail(r)}),e.setQueryData(w.lists(),e=>null==e?void 0:e.filter(e=>e.transaction_id!==r)),e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["reports"]})},onError:e=>{console.error("Error deleting transaction:",e)}});return{getTransactions:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.useQuery)({queryKey:w.list({userId:e,...r}),queryFn:()=>g.getTransactions(e,r),enabled:!!e,staleTime:12e4})},getTransactionById:e=>(0,t.useQuery)({queryKey:w.detail(e),queryFn:()=>g.getTransactionById(e),enabled:!!e,staleTime:3e5}),getTransactionsByWallet:e=>(0,t.useQuery)({queryKey:w.byWallet(e),queryFn:()=>g.getTransactionsByWallet(userId,e),enabled:!!userId&&!!e,staleTime:12e4}),getTransactionsByCategory:(e,r)=>(0,t.useQuery)({queryKey:w.byCategory(r),queryFn:()=>g.getTransactionsByCategory(e,r),enabled:!!e&&!!r,staleTime:12e4}),getTransactionsByDateRange:(e,r,a)=>(0,t.useQuery)({queryKey:w.byDateRange(r,a),queryFn:()=>g.getTransactionsByDateRange(e,r,a),enabled:!!e&&!!r&&!!a,staleTime:12e4}),createTransaction:e=>n.mutateAsync(e),updateTransaction:(e,t)=>s.mutateAsync({transactionId:e,updates:t}),deleteTransaction:e=>l.mutateAsync(e),clearError:()=>{n.reset(),s.reset(),l.reset()},mutations:{createTransaction:n,updateTransaction:s,deleteTransaction:l}}},m=f},20797,e=>{"use strict";e.s(["useWallets",()=>d,"walletKeys",()=>c],20797);var t=e.i(66027),r=e.i(54616),a=e.i(12598),n=e.i(22459);async function s(e){let{data:t,error:r}=await n.supabase.from("wallets").select("*").eq("user_id",e).order("created_at",{ascending:!1});return{data:t,error:r}}async function l(e){let{data:t,error:r}=await n.supabase.from("wallets").insert([e]).select();return{data:t,error:r}}async function i(e,t){let{data:r,error:a}=await n.supabase.from("wallets").update(t).eq("wallet_id",e).select();return{data:r,error:a}}async function o(e){let{data:t,error:r}=await n.supabase.from("wallets").delete().eq("wallet_id",e);return{data:t,error:r}}let u=new class{async getWallets(e){try{return await s(e)}catch(e){return console.error("Error fetching wallets:",e),{data:null,error:e}}}async createWallet(e){try{if(!e.user_id||!e.wallet_name)throw Error("User ID and wallet name are required");return await l(e)}catch(e){return console.error("Error creating wallet:",e),{data:null,error:e}}}async createDefaultWallet(e){try{return await this.createWallet({user_id:e,wallet_name:"Main Wallet",balance:0,currency:"PHP"})}catch(e){return console.error("Error creating default wallet:",e),{data:null,error:e}}}async updateWallet(e,t){try{if(!e)throw Error("Wallet ID is required");return await i(e,t)}catch(e){throw console.error("Error updating wallet:",e),e}}async deleteWallet(e){try{return await o(e)}catch(e){return console.error("Error deleting wallet:",e),{error:e}}}},c={all:["wallets"],lists:()=>[...c.all,"list"],list:e=>[...c.lists(),{filters:e}],details:()=>[...c.all,"detail"],detail:e=>[...c.details(),e]},d=()=>{let e=(0,a.useQueryClient)(),n=(0,r.useMutation)({mutationFn:u.createWallet,onSuccess:t=>{t.data&&e.invalidateQueries({queryKey:c.lists()})},onError:e=>{console.error("Error creating wallet:",e)}}),s=(0,r.useMutation)({mutationFn:u.createDefaultWallet,onSuccess:t=>{t.data&&e.invalidateQueries({queryKey:c.lists()})},onError:e=>{console.error("Error creating default wallet:",e)}}),l=(0,r.useMutation)({mutationFn:e=>{let{walletId:t,updates:r}=e;return u.updateWallet(t,r)},onSuccess:(t,r)=>{t.data&&e.setQueryData(c.lists(),e=>null==e?void 0:e.map(e=>e.wallet_id===r.walletId?t.data[0]:e))}}),i=(0,r.useMutation)({mutationFn:u.deleteWallet,onSuccess:(t,r)=>{e.setQueryData(c.lists(),e=>null==e?void 0:e.filter(e=>e.wallet_id!==r))}});return{getWallets:e=>(0,t.useQuery)({queryKey:c.list({userId:e}),queryFn:()=>u.getWallets(e),enabled:!!e,staleTime:12e4}),createWallet:e=>n.mutateAsync(e),createDefaultWallet:e=>s.mutateAsync(e),updateWallet:(e,t)=>l.mutateAsync({walletId:e,updates:t}),deleteWallet:e=>i.mutateAsync(e),clearError:()=>{n.reset(),s.reset(),l.reset(),i.reset()},mutations:{createWallet:n,createDefaultWallet:s,updateWallet:l,deleteWallet:i}}}},97670,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(43476),r=e.i(12598),a=e.i(63357),n=e.i(79899),s=e.i(71645),l=e.i(20797),i=e.i(86647);function o(e){let{children:o}=e;return(0,s.useEffect)(()=>{try{var e;let t=window.__FINTRACK_INITIAL_SESSION__,r=window.__FINTRACK_INITIAL_DATA__,n=null==t||null==(e=t.user)?void 0:e.id;n&&r&&(r.wallets&&a.queryClient.setQueryData(l.walletKeys.list({userId:n}),r.wallets),r.transactions&&a.queryClient.setQueryData(i.transactionKeys.list({userId:n}),r.transactions),r.budgets&&a.queryClient.setQueryData(["budgets","list",{userId:n}],r.budgets),r.goals&&a.queryClient.setQueryData(["goals","list",{userId:n}],r.goals))}catch(e){}},[]),(0,t.jsx)(r.QueryClientProvider,{client:a.queryClient,children:(0,t.jsx)(n.UserProvider,{children:o})})}}]);