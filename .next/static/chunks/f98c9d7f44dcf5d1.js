(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},76057,e=>{"use strict";e.s(["default",()=>i]);var t=e.i(43476),a=e.i(71645),n=e.i(54156),s=e.i(86647),r=e.i(79899),l=e.i(22459);function i(){let{createTransaction:e,getTransactions:i,mutations:o}=(0,s.default)(),{createTransaction:c}=o,{user:d,loading:x}=(0,r.useUser)(),[m,u]=(0,a.useState)({amount:"",transaction_type:"expense",date:new Date().toISOString().split("T")[0],description:"",category_id:"",wallet_id:""}),[h,g]=(0,a.useState)([]),[p,f]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[j,y]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),[_,k]=(0,a.useState)([]),[S,C]=(0,a.useState)(!1),T=(0,a.useCallback)(async()=>{if(null==d?void 0:d.id){C(!0);try{let{data:e,error:t}=await l.supabase.from("transactions").select("\n          *,\n          categories (category_name, category_type),\n          wallets (wallet_name, currency)\n        ").eq("user_id",d.id).order("date",{ascending:!1}).order("created_at",{ascending:!1}).limit(50);t?console.error("Error fetching transactions:",t):(k(e||[]),console.log("≡ƒôï Transactions fetched:",null==e?void 0:e.length))}catch(e){console.error("Error fetching transactions:",e)}finally{C(!1)}}},[d]);(0,a.useEffect)(()=>{(async()=>{if(null==d?void 0:d.id)try{console.log("≡ƒöä Starting to fetch categories...");let{data:e,error:t}=await l.supabase.from("categories").select("category_id, category_name, category_type").order("category_name",{ascending:!0});if(console.log("≡ƒôè Categories fetch result:",{data:e,error:t,count:null==e?void 0:e.length}),!t&&e){g(e),console.log("Γ£à Categories set in state:",e.length,"categories");let t=e.filter(e=>"expense"===e.category_type);f(t),console.log("≡ƒÆ░ Filtered expense categories:",t.length)}else console.error("Γ¥î Error fetching categories:",t);let{data:a,error:n}=await l.supabase.from("wallets").select("wallet_id, wallet_name, balance, currency").eq("user_id",d.id).order("created_at",{ascending:!1});console.log("≡ƒæ¢ Wallets fetch result:",{data:a,error:n,count:null==a?void 0:a.length}),!n&&a?w(a):console.error("Error fetching wallets:",n),await T()}catch(e){console.error("Error fetching data:",e)}finally{y(!1)}})()},[null==d?void 0:d.id,T]),(0,a.useEffect)(()=>{h.length>0&&(f(h.filter(e=>e.category_type===m.transaction_type)),u(e=>({...e,category_id:""})))},[m.transaction_type,h]);let E=e=>{let{name:t,value:a}=e.target;u(e=>({...e,[t]:a}))},P=e=>{u(t=>({...t,transaction_type:e}))},D=async t=>{if(t.preventDefault(),!(null==d?void 0:d.id))return void console.error("User not found. Please make sure you're logged in.");if(!m.amount||!m.wallet_id||!m.category_id)return void console.error("Amount, wallet, and category are required");try{let t={user_id:d.id,amount:parseFloat(m.amount),transaction_type:m.transaction_type,date:m.date,description:m.description||null,wallet_id:m.wallet_id,category_id:m.category_id,budget_id:null,goal_id:null};console.log("Submitting transaction:",t);let a=await e(t);if(console.log("Transaction creation result:",a),a.error)throw Error(a.error.message);N(!0),u({amount:"",transaction_type:m.transaction_type,date:new Date().toISOString().split("T")[0],description:"",category_id:"",wallet_id:m.wallet_id}),await T(),setTimeout(()=>N(!1),3e3)}catch(e){console.error("Failed to create transaction:",e)}},L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PHP";return new Intl.NumberFormat("en-PH",{style:"currency",currency:t,minimumFractionDigits:2}).format(e)},O=c.isPending||x||j,q=c.error;return x?(0,t.jsxs)("div",{className:"min-h-screen bg-[#21121e] text-white font-sans",children:[(0,t.jsx)(n.default,{}),(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-white",children:"Loading..."})})]}):d||x?(0,t.jsxs)("div",{className:"min-h-screen bg-[#21121e] text-white font-sans",children:[(0,t.jsx)(n.default,{}),(0,t.jsx)("main",{className:"flex flex-col items-center py-8 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"mt-15 w-full max-w-6xl",children:[(0,t.jsx)("div",{className:"flex flex-wrap justify-between gap-3 p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex w-full flex-col gap-3 text-center",children:[(0,t.jsx)("h1",{className:"text-white text-3xl sm:text-4xl font-black leading-tight tracking-[-0.033em]",children:"Transactions"}),(0,t.jsx)("p",{className:"text-accent-cream/70 text-base font-normal leading-normal",children:"Record your income and expenses to track your finances."})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{children:[v&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-green-500/20 border border-green-500 rounded-lg text-green-300 text-center",children:"Transaction created successfully!"}),q&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500 rounded-lg text-red-300 text-center",children:["Error: ",q.message]}),(0,t.jsxs)("div",{className:"bg-white/10 p-6 sm:p-8 rounded-xl flex flex-col gap-6",children:[(0,t.jsx)("h2",{className:"text-white text-2xl font-bold text-center",children:"Add New Transaction"}),(0,t.jsxs)("form",{onSubmit:D,className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsxs)("div",{className:"flex items-center bg-black/30 p-1 rounded-full",children:[(0,t.jsx)("button",{type:"button",className:"px-4 sm:px-6 py-2 text-sm font-bold rounded-full transition-colors cursor-pointer ".concat("expense"===m.transaction_type?"bg-[#9c167f] text-white":"text-accent-cream/70 hover:text-accent-cream"),onClick:()=>P("expense"),children:"Expense"}),(0,t.jsx)("button",{type:"button",className:"px-4 sm:px-6 py-2 text-sm font-medium rounded-full transition-colors cursor-pointer ".concat("income"===m.transaction_type?"bg-[#9c167f] text-white":"text-accent-cream/70 hover:text-accent-cream"),onClick:()=>P("income"),children:"Income"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white text-base font-medium leading-normal pb-2",children:"Amount *"}),(0,t.jsx)("input",{name:"amount",value:m.amount,onChange:E,className:"w-full rounded-lg text-white focus:outline-none focus:ring-2 border border-transparent bg-black/20 focus:border-black h-12 sm:h-14 placeholder:text-white/30 px-4 text-base font-normal leading-normal",placeholder:"₱0.00",type:"number",step:"0.01",min:"0.01",required:!0})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white text-base font-medium leading-normal pb-2",children:"Wallet *"}),(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsxs)("select",{name:"wallet_id",value:m.wallet_id,onChange:E,className:"appearance-none w-full cursor-pointer rounded-lg text-white focus:outline-none focus:ring-2 border border-transparent bg-black/20 focus:border-black/20 h-12 sm:h-14 px-4 text-base font-normal leading-normal",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Wallet"}),b.map(e=>(0,t.jsxs)("option",{value:e.wallet_id,children:[e.wallet_name," (",e.currency,")"]},e.wallet_id))]}),(0,t.jsx)("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-white",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white text-base font-medium leading-normal pb-2",children:"Date *"}),(0,t.jsxs)("div",{className:"flex w-full items-stretch rounded-lg",children:[(0,t.jsx)("input",{name:"date",value:m.date,onChange:E,className:"flex-1 rounded-l-lg text-white focus:outline-none focus:ring-2 border border-transparent bg-black/20 focus:border-black h-12 sm:h-14 placeholder:text-white/30 px-4 border-r-0 text-base font-normal leading-normal",type:"date",required:!0}),(0,t.jsx)("div",{className:"text-white flex border border-transparent bg-black/20 items-center justify-center px-3 sm:px-4 rounded-r-lg border-l-0",children:(0,t.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white text-base font-medium leading-normal pb-2",children:"Category *"}),(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsxs)("select",{name:"category_id",value:m.category_id,onChange:E,className:"appearance-none w-full cursor-pointer rounded-lg text-white focus:outline-none focus:ring-2 border border-transparent bg-black/20 focus:border-black/20 h-12 sm:h-14 px-4 text-base font-normal leading-normal",required:!0,children:[(0,t.jsxs)("option",{value:"",children:["Select"," ","income"===m.transaction_type?"Income":"Expense"," ","Category"]}),p.map(e=>(0,t.jsx)("option",{value:e.category_id,children:e.category_name},e.category_id))]}),(0,t.jsx)("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-white",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,t.jsxs)("p",{className:"text-white/50 text-sm mt-1",children:["income"===m.transaction_type?"Income categories":"Expense categories"," ","(",p.length," available)"]})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white text-base font-medium leading-normal pb-2",children:"Description"}),(0,t.jsx)("textarea",{name:"description",value:m.description,onChange:E,className:"w-full rounded-lg text-white focus:outline-none focus:ring-2 border border-transparent bg-black/20 focus:border-black/20 min-h-24 placeholder:text-white/30 p-4 text-base font-normal leading-normal resize-none",placeholder:"Add a description (optional)",rows:3})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{u({amount:"",transaction_type:"expense",date:new Date().toISOString().split("T")[0],description:"",category_id:"",wallet_id:""})},disabled:O,className:"w-full sm:w-auto flex items-center justify-center rounded-full h-12 bg-black/10 text-accent-cream text-sm font-bold leading-normal tracking-[0.015em] px-6 sm:px-8 border-2 border-[#9c167f] hover:bg-[#9c167f] transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:O,className:"w-full sm:w-auto flex items-center justify-center rounded-full h-12 bg-[#9c167f] text-white text-sm font-bold leading-normal tracking-[0.015em] px-6 sm:px-8 hover:bg-[#9c167f]/90 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:O?"Saving...":"Save Transaction"})]})]})]})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"bg-white/10 p-6 sm:p-8 rounded-xl",children:[(0,t.jsx)("h2",{className:"text-white text-2xl font-bold text-center mb-6",children:"Recent Transactions"}),S?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("div",{className:"text-white",children:"Loading transactions..."})}):0===_.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-white/50",children:"No transactions yet"}),(0,t.jsx)("p",{className:"text-white/30 text-sm mt-2",children:"Your transactions will appear here"})]}):(0,t.jsx)("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:_.map(e=>{var a,n,s;return(0,t.jsx)("div",{className:"bg-black/20 rounded-lg p-4 border border-white/10",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 rounded-full ".concat("income"===e.transaction_type?"bg-green-500":"bg-red-500")}),(0,t.jsx)("span",{className:"text-white font-medium",children:null==(a=e.categories)?void 0:a.category_name})]}),(0,t.jsx)("p",{className:"text-white/70 text-sm",children:e.description||"No description"}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,t.jsx)("span",{className:"text-white/50 text-xs",children:new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),(0,t.jsx)("span",{className:"text-white/50 text-xs",children:null==(n=e.wallets)?void 0:n.wallet_name})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("div",{className:"text-lg font-bold ".concat("income"===e.transaction_type?"text-green-400":"text-red-400"),children:["income"===e.transaction_type?"+":"-",L(e.amount,null==(s=e.wallets)?void 0:s.currency)]})})]})},e.transaction_id)})})]})})]})]})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-[#21121e] text-white font-sans",children:[(0,t.jsx)(n.default,{}),(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-white text-center",children:(0,t.jsx)("p",{children:"Please log in to add transactions."})})})]})}}]);