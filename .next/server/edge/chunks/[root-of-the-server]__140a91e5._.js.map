{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\n\r\n// Middleware performs light, non-destructive checks for session cookies.\r\n// NOTE: This middleware tries to detect common Supabase session cookie names.\r\n// Because this project currently stores auth tokens in localStorage, middleware\r\n// cannot reliably enforce dashboard protection until a server-set cookie is available.\r\n\r\nconst PUBLIC_FILE = /\\.(.*)$/;\r\n\r\nexport function middleware(req) {\r\n  const { pathname } = req.nextUrl;\r\n\r\n  // Skip public files and _next static files\r\n  if (PUBLIC_FILE.test(pathname) || pathname.startsWith(\"/_next\")) {\r\n    return NextResponse.next();\r\n  }\r\n\r\n  // common cookie names to probe (best-effort)\r\n  const tokenCookieNames = [\r\n    \"supabase.auth.token\",\r\n    \"supabase-session\",\r\n    \"sb:token\",\r\n    \"sb-access-token\",\r\n    \"supabase_token\",\r\n    \"fintrack_session\",\r\n  ];\r\n\r\n  let hasSession = false;\r\n  try {\r\n    for (const name of tokenCookieNames) {\r\n      const cookie = req.cookies.get ? req.cookies.get(name) : null;\r\n      if (cookie) {\r\n        const value = cookie.value ?? cookie;\r\n        if (value && value !== \"null\") {\r\n          hasSession = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  } catch (err) {\r\n    // If cookie access fails, don't block â€” fallback to allow\r\n    hasSession = false;\r\n  }\r\n\r\n  // If user is on login or signup and already has a session cookie, redirect them away\r\n  if (\r\n    (pathname === \"/pages/login\" || pathname === \"/pages/signup\") &&\r\n    hasSession\r\n  ) {\r\n    const url = req.nextUrl.clone();\r\n    url.pathname = \"/pages/dashboard\";\r\n    return NextResponse.redirect(url);\r\n  }\r\n\r\n  // For dashboard routes we do not force-redirect when session cookie is missing\r\n  // because many sessions are stored in localStorage in the current app.\r\n  // Use server-side layout checks for robust protection.\r\n\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/pages/login\", \"/pages/signup\", \"/pages/dashboard/:path*\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEA,yEAAyE;AACzE,8EAA8E;AAC9E,gFAAgF;AAChF,uFAAuF;AAEvF,MAAM,cAAc;AAEb,SAAS,WAAW,GAAG;IAC5B,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,2CAA2C;IAC3C,IAAI,YAAY,IAAI,CAAC,aAAa,SAAS,UAAU,CAAC,WAAW;QAC/D,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,6CAA6C;IAC7C,MAAM,mBAAmB;QACvB;QACA;QACA;QACA;QACA;QACA;KACD;IAED,IAAI,aAAa;IACjB,IAAI;QACF,KAAK,MAAM,QAAQ,iBAAkB;YACnC,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ;YACzD,IAAI,QAAQ;gBACV,MAAM,QAAQ,OAAO,KAAK,IAAI;gBAC9B,IAAI,SAAS,UAAU,QAAQ;oBAC7B,aAAa;oBACb;gBACF;YACF;QACF;IACF,EAAE,OAAO,KAAK;QACZ,0DAA0D;QAC1D,aAAa;IACf;IAEA,qFAAqF;IACrF,IACE,CAAC,aAAa,kBAAkB,aAAa,eAAe,KAC5D,YACA;QACA,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;QAC7B,IAAI,QAAQ,GAAG;QACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,+EAA+E;IAC/E,uEAAuE;IACvE,uDAAuD;IAEvD,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAgB;QAAiB;KAA0B;AACvE"}}]
}